{"version":3,"file":"firebase_object_observable.spec.js","sourceRoot":"","sources":["../../../src/database-deprecated/firebase_object_observable.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import { TestBed, inject } from '@angular/core/testing';\nimport { FirebaseApp, FirebaseAppConfig, AngularFireModule } from 'angularfire2';\nimport { COMMON_CONFIG } from './test-config';\nimport { AngularFireDatabase, AngularFireDatabaseModule, FirebaseObjectObservable } from 'angularfire2/database-deprecated';\nimport { Observer } from 'rxjs/Observer';\nimport { map } from 'rxjs/operator/map';\nimport { FirebaseApp as FBApp } from '@firebase/app-types';\nimport { Reference } from '@firebase/database-types';\n\ndescribe('FirebaseObjectObservable', () => {\n\n  let O: FirebaseObjectObservable<any>;\n  let ref: Reference;\n  let app: FBApp;\n  let db: AngularFireDatabase;\n\n  beforeEach(() => {\n    TestBed.configureTestingModule({\n      imports: [\n        AngularFireModule.initializeApp(COMMON_CONFIG),\n        AngularFireDatabaseModule\n      ]\n    });\n    inject([FirebaseApp, AngularFireDatabase], (_app: FBApp, _db: AngularFireDatabase) => {\n      app = _app;\n      db = _db;\n      ref = app.database().ref();\n      O = new FirebaseObjectObservable((observer: Observer<any>) => {\n      }, ref);\n    })();\n  });\n\n  afterEach(done => {\n    ref.off();\n    ref.remove();\n    app.delete().then(done, done.fail);\n  });\n\n  it('should return an instance of FirebaseObservable when calling operators', () => {\n    let O = new FirebaseObjectObservable((observer: Observer<any>) => { });\n    expect(map.call(O, noop) instanceof FirebaseObjectObservable).toBe(true);\n  });\n\n  describe('$ref', () => {\n    it('should match the database path passed in the constructor', () => {\n      expect(O.$ref!.toString()).toEqual(ref.toString());\n    });\n  });\n\n  describe('set', () => {\n\n    it('should call set on the underlying ref', (done: any) => {\n      let setSpy = spyOn(ref, 'set');\n\n      O.subscribe();\n      O.set(1);\n      expect(setSpy).toHaveBeenCalledWith(1);\n      done();\n    });\n\n    it('should throw an exception if set when not subscribed', () => {\n      O = new FirebaseObjectObservable((observer: Observer<any>) => { });\n\n      expect(() => {\n        O.set('foo');\n      }).toThrowError('No ref specified for this Observable!')\n    });\n\n    it('should accept any type of value without compilation error', () => {\n      O.set('foo');\n    });\n\n\n    it('should resolve returned thenable when successful', (done: any) => {\n      O.set('foo').then(done, done.fail);\n    });\n\n  });\n\n  describe('update', () => {\n    const updateObject = { hot: 'firebae' };\n    it('should call update on the underlying ref', () => {\n      let updateSpy = spyOn(ref, 'update');\n\n      O.subscribe();\n      O.update(updateObject);\n      expect(updateSpy).toHaveBeenCalledWith(updateObject);\n    });\n\n    it('should throw an exception if updated when not subscribed', () => {\n      O = new FirebaseObjectObservable((observer: Observer<any>) => { });\n\n      expect(() => {\n        O.update(updateObject);\n      }).toThrowError('No ref specified for this Observable!')\n    });\n\n    it('should accept any type of value without compilation error', () => {\n      O.update(updateObject);\n    });\n\n    it('should resolve returned thenable when successful', (done: any) => {\n      O.update(updateObject).then(done, done.fail);\n    });\n\n  });\n\n  describe('remove', () => {\n\n    it('should call remove on the underlying ref', () => {\n      let removeSpy = spyOn(ref, 'remove');\n\n      O.subscribe();\n      O.remove();\n      expect(removeSpy).toHaveBeenCalledWith();\n    });\n\n    it('should throw an exception if removed when not subscribed', () => {\n      O = new FirebaseObjectObservable((observer: Observer<any>) => { });\n\n      expect(() => {\n        O.remove();\n      }).toThrowError('No ref specified for this Observable!')\n    });\n\n    it('should resolve returned thenable when successful', (done: any) => {\n      O.remove().then(done, done.fail);\n    });\n\n  });\n\n});\n\nfunction noop() { }\n"]}